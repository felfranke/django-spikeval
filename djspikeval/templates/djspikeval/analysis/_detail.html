{% load i18n %}
{#{% load module_tags %}#}
{% load base %}
{% load spikeval %}

<div class="panel panel-default">
  <div id="heading-eval-{{ obj.id }}" class="panel-heading clearfix" role="tab">
    <a class="btn btn-default pull-left" href="#eval-{{ obj.id }}" data-toggle="collapse"
       data-parent="#trial-container">
      TOGGLE DETAILS
    </a>
    <dl class="dl-horizontal pull-left" style="margin-bottom: 0px;">
      <dt>
        <strong>Ident:</strong>
      </dt>
      <dd>
        {{ obj }}
      </dd>
      <dt>
        <strong>Status:</strong>
      </dt>
      <dd>
        {{ obj.status }}
      </dd>
      <dt>
        <strong>Created:</strong>
      </dt>
      <dd>
        {% fa_text obj.created|date "clock-o" %}
      </dd>
      <dt>
        <strong>Modified:</strong>
      </dt>
      <dd>
        {% fa_text obj.modified|date "clock-o" %}
      </dd>
      <dt></dt>
    </dl>
  </div>
  <div id="eval-{{ obj.id }}" class="panel-collapse collapse" role="tabpanel"
       aria-labelledby="heading-eval-{{ obj.id }}" style="margin: 5px;">
    <div class="panel-body">
      {% if user.is_authenticated %}
        {% if obj|is_editable:user %}
          <div class="well well-sm">
            <div class="btn-group btn-group-sm input-group input-group-sm">
              <span class="input-group-addon">Actions:</span>
              {% if object|is_editable:user %}
                {% action "Restart" icon="refresh" href="analysis:start" pk=obj.id %}
                <span class="btn btn-default"
                      onclick="$('#log-{{ obj.id }}').toggle();return false;">
                {% trans "Show Log" %}
              </span>
              {% endif %}
            </div>
          </div>
          <pre id="log-{{ obj.id }}" class="well" {% if obj.processed %}style="display:none"{% endif %}>
          {{ obj.task_log }}
        </pre>
        {% endif %}
      {% endif %}
      {% if obj.processed %}
        {% for mod in obj.modules %}
          <div class="well well-small">
            <h2 class="pull-left">Module: {{ mod.name }}</h2>
          <span href="#" rel="popover" class="btn btn-large pull-right"
                id="eval-{{ obj.id }}-mod-{{ mod.id }}-desc"
                data-content="{{ mod.description }}"
                data-original-title="{{ mod.name }}"
                data-placement="left">MODULE DESCRIPTION</span>
            <script type="text/javascript">
              $(function () {
                $("#eval-{{ obj.id }}-mod-{{ mod.id }}-desc").popover();
              });
            </script>
            <div class="clearfix"></div>
            <p>render results here</p>
            {#          {% render_results obj mod %}#}
          </div>
        {% endfor %}
      {% endif %}
    </div>
  </div>
</div>
