{% load i18n %}
{% load bootstrap3 %}
{% load fa_tags %}
{% load spikeval_tags %}


<h2>Trial Set
  <small>tuples of rawdata and groundtruth</small>
</h2>
<p>Benchmarks consist of one or more Trials. You may download Trials and apply your spike sorting
  algorithm. After the spike sorting on your end, you upload the resulting spike train set here and
  start an Evaluation.</p>

{% if obj.trial_set.all %}
  <table class="table table-striped table-condensed">
    <thead>
    <tr>
      <th>{% trans "Name" %}</th>
      <th>{% trans "Created" %}</th>
      <th>{{ obj.parameter }}</th>
      <th>{% trans "Description" %}</th>
      <th>{% trans "Download" %}</th>
      {% ifequal obj.owner user %}
        <th>{% trans "Status" %}</th>
      {% endifequal %}
    </tr>
    </thead>
    <tbody>
    {% for tr in obj.trial_set.all %}
      <tr>
        <td>
          {% if obj|is_editable:user %}<a href="{{ tr.get_absolute_url }}">{% endif %}
          <nobr><strong>{{ tr }}</strong></nobr>
          {% if obj|is_editable:user %}</a>{% endif %}
        </td>
        <td>
          {% fa_text tr.created|date "clock-o" %}
        </td>
        <td>
          {{ tr.parameter }}
        </td>
        <td>
          {{ tr.description|truncatewords:15|escape }}
        </td>
        <td>
          <nobr>
            <a href="{{ tr.rd_file.get_absolute_url }}">
              {{ tr.rd_file.name }} - {{ tr.rd_file.size|filesizeformat }}
            </a>
          </nobr>
          {% if tr.gt_public or obj|is_editable:user %}
            </br>
            <nobr>
              <a href="{{ tr.gt_file.get_absolute_url }}">
                {{ tr.gt_file.name }} - {{ tr.gt_file.size|filesizeformat }}
              </a>
            </nobr>
          {% endif %}
        </td>
        {% if obj|is_editable:user %}
          <td>
            {% if tr.is_valid %}
              {% fa_text "VALID" "check-circle" color="green" strong=True %}
            {% else %}
              {% fa_text "INVALID" "exclamation-circle" color="red" strong=True %}
            {% endif %}
          </td>
        {% endif %}
      </tr>
    {% endfor %}
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>
        <a href="{% url "benchmark:download" object.id %}"
           class="btn btn-default btn-xs">{% trans "download" %}</a>
      </td>
      {% ifequal object.owner user %}
        <td></td>
      {% endifequal %}
    </tr>
    </tbody>
  </table>
{% else %}
  <p>This benchmark has no trials yet.
    {% ifequal object.owner request.user %}
      You can add new trials by clicking on the "Create Trial" button above.
    {% endifequal %}
  </p>
{% endif %}
