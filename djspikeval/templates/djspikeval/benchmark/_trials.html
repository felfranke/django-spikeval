{% load i18n %}
{% load bootstrap3 %}
{% load fa_tags %}
{% load spikeval_tags %}


<h2>Trial Set
  <small>tuples of rawdata and groundtruth</small>
</h2>
<p>Benchmarks consist of one or more Trials. You may download Trials and apply your spike sorting
  algorithm. After the spike sorting on your end, you upload the resulting spike train set here and
  start an Evaluation.</p>

{% if object.trial_set.all %}
  <table class="table table-striped table-condensed">
    <thead>
    <tr>
      <th>{% trans "Name" %}</th>
      <th>{% trans "Created" %}</th>
      <th>{{ object.parameter }}</th>
      <th>{% trans "Description" %}</th>
      <th>{% trans "Download" %}</th>
      {% ifequal object.owner user %}
        <th>{% trans "Status" %}</th>
      {% endifequal %}
    </tr>
    </thead>
    <tbody>
    {% for tr in object.trial_set.all %}
      <tr>
        <td>
          {% if object|is_editable:user %}
            <a href="{{ tr.get_absolute_url }}">
          {% endif %}
          <nobr><strong>{{ tr }}</strong></nobr>
          {% if object|is_editable:user %}
            </a>
          {% endif %}
        </td>
        <td>
          <nobr>
            <i class="icon-time"></i>
            {{ tr.modified|date }}
          </nobr>
        </td>
        <td>
          {{ tr.parameter }}
        </td>
        <td>
          {{ tr.description|truncatewords:15|escape }}
        </td>
        {% with tr.rd_file as f %}
          <td>
            <nobr>
              <a href="{{ f.get_absolute_url }}">
                {{ f.name }} - {{ f.size|filesizeformat }}
              </a>
            </nobr>
            {{ tr.gt_public }}
            {% if tr.gt_public or object|is_editable:user %}
              {% with tr.gt_file as f %}
                </br>
                <nobr>
                  <a href="{{ f.get_absolute_url }}">
                    {{ f.name }} - {{ f.size|filesizeformat }}
                  </a>
                </nobr>
              {% endwith %}
            {% endif %}
          </td>
        {% endwith %}
        {% if object|is_editable:user %}
          <td>
            {% if tr.is_valid %}
              <i class="icon-ok"></i>
              <strong style="color: green">VALID</strong>
            {% else %}
              <i class="icon-exclamation-sign"></i>
              <strong style="color: red">INVALID</strong>
            {% endif %}
          </td>
        {% endif %}
      </tr>
    {% endfor %}
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>
        <a href="{% url "benchmark:download" object.id %}"
           class="btn btn-default btn-xs">{% trans "download" %}</a>
      </td>
      {% ifequal object.owner user %}
        <td></td>
      {% endifequal %}
    </tr>
    </tbody>
  </table>
{% else %}
  <p>This benchmark has no trials yet.
    {% ifequal object.owner request.user %}
      You can add new trials by clicking on the "Create Trial" button above.
    {% endifequal %}
  </p>
{% endif %}
